<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>DarkDna Radio</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet" />

  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: "Rajdhani", sans-serif;
      background: #000;
      color: #fff;
      overflow: hidden;
      position: fixed;
      width: 100%;
      height: 100vh;
      height: 100dvh;
    }

    /* Background animato con DNA helix */
    .bg-container {
      position: fixed;
      inset: 0;
      overflow: hidden;
      z-index: 0;
    }

    .dna-strand {
      position: absolute;
      width: 4px;
      height: 100%;
      background: linear-gradient(180deg, 
        transparent 0%, 
        rgba(139, 0, 255, 0.4) 20%, 
        rgba(0, 255, 255, 0.4) 50%,
        rgba(139, 0, 255, 0.4) 80%,
        transparent 100%);
      animation: dnaFlow 8s linear infinite;
      filter: blur(2px);
    }

    .dna-strand:nth-child(1) { left: 20%; animation-delay: 0s; }
    .dna-strand:nth-child(2) { left: 40%; animation-delay: -2s; }
    .dna-strand:nth-child(3) { left: 60%; animation-delay: -4s; }
    .dna-strand:nth-child(4) { left: 80%; animation-delay: -6s; }

    @keyframes dnaFlow {
      0% { transform: translateY(-100%) rotate(0deg); }
      100% { transform: translateY(100%) rotate(360deg); }
    }

    /* Particelle fluttuanti */
    .particle {
      position: absolute;
      width: 3px;
      height: 3px;
      background: rgba(0, 255, 255, 0.6);
      border-radius: 50%;
      animation: particleFloat 15s infinite;
      box-shadow: 0 0 10px rgba(0, 255, 255, 0.8);
    }

    @keyframes particleFloat {
      0%, 100% { transform: translate(0, 0) scale(1); opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { transform: translate(var(--tx), var(--ty)) scale(0.5); opacity: 0; }
    }

    /* Onde audio visualizer */
    .audio-wave {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 150px;
      display: flex;
      align-items: flex-end;
      justify-content: space-evenly;
      gap: 4px;
      padding: 0 20px;
      opacity: 0.3;
      pointer-events: none;
    }

    .wave-bar {
      flex: 1;
      background: linear-gradient(180deg, rgba(139, 0, 255, 0.9), rgba(0, 255, 255, 0.9));
      border-radius: 4px 4px 0 0;
      min-height: 10px;
      animation: waveAnimation 0.8s ease-in-out infinite;
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
    }

    .wave-bar:nth-child(even) { animation-delay: 0.1s; }
    .wave-bar:nth-child(3n) { animation-delay: 0.2s; }
    .wave-bar:nth-child(5n) { animation-delay: 0.3s; }

    @keyframes waveAnimation {
      0%, 100% { height: 20px; opacity: 0.3; }
      50% { height: 100px; opacity: 0.8; }
    }

    .wave-bar.playing {
      animation-play-state: running;
    }

    .wave-bar.paused {
      animation-play-state: paused;
      height: 20px !important;
    }

    /* Container principale */
    .app {
      position: relative;
      z-index: 10;
      width: 100%;
      height: 100vh;
      height: 100dvh;
      display: flex;
      flex-direction: column;
      padding: 0;
    }

    /* Header con logo */
    .header {
      padding: 30px 24px 20px;
      text-align: center;
      background: linear-gradient(180deg, rgba(0, 0, 0, 0.9) 0%, transparent 100%);
    }

    .logo-container {
      display: inline-flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      animation: logoGlow 3s ease-in-out infinite;
    }

    @keyframes logoGlow {
      0%, 100% { filter: drop-shadow(0 0 20px rgba(139, 0, 255, 0.6)); }
      50% { filter: drop-shadow(0 0 40px rgba(0, 255, 255, 0.8)); }
    }

    .logo-text {
      font-family: "Orbitron", monospace;
      font-size: 2.8rem;
      font-weight: 800;
      background: linear-gradient(135deg, #8b00ff 0%, #00ffff 50%, #8b00ff 100%);
      background-size: 200% 200%;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      animation: gradientShift 4s ease infinite;
      letter-spacing: 4px;
      text-transform: uppercase;
    }

    @keyframes gradientShift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .logo-subtitle {
      font-size: 0.9rem;
      color: rgba(0, 255, 255, 0.7);
      letter-spacing: 3px;
      text-transform: uppercase;
      font-weight: 300;
    }

    .live-indicator {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      margin-top: 12px;
      padding: 6px 16px;
      background: rgba(139, 0, 255, 0.2);
      border: 1px solid rgba(139, 0, 255, 0.5);
      border-radius: 20px;
      font-size: 0.8rem;
      letter-spacing: 2px;
    }

    .live-dot {
      width: 10px;
      height: 10px;
      background: #00ffff;
      border-radius: 50%;
      animation: livePulse 2s ease-in-out infinite;
      box-shadow: 0 0 15px #00ffff;
    }

    @keyframes livePulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.5; transform: scale(1.3); }
    }

    /* Area centrale - Player */
    .player-section {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 20px 24px;
      position: relative;
    }

    /* Disco vinile animato */
    .vinyl-container {
      position: relative;
      width: 280px;
      height: 280px;
      margin-bottom: 40px;
    }

    .vinyl-disc {
      width: 100%;
      height: 100%;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #1a1a1a 0%, #000 40%, #8b00ff 100%);
      box-shadow: 
        0 0 60px rgba(139, 0, 255, 0.6),
        inset 0 0 40px rgba(0, 0, 0, 0.8);
      position: relative;
      animation: vinylRotate 4s linear infinite paused;
    }

    .vinyl-disc.playing {
      animation-play-state: running;
    }

    .vinyl-disc::before {
      content: '';
      position: absolute;
      inset: 40px;
      border-radius: 50%;
      background: radial-gradient(circle, #000 30%, transparent 31%, transparent 60%, #000 61%);
      opacity: 0.6;
    }

    .vinyl-disc::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 60px;
      height: 60px;
      margin: -30px 0 0 -30px;
      border-radius: 50%;
      background: radial-gradient(circle, #00ffff 0%, #8b00ff 100%);
      box-shadow: 0 0 30px rgba(0, 255, 255, 0.8);
    }

    @keyframes vinylRotate {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    /* Glow ring attorno al vinile */
    .vinyl-glow {
      position: absolute;
      inset: -20px;
      border-radius: 50%;
      border: 2px solid transparent;
      background: linear-gradient(45deg, #8b00ff, #00ffff, #8b00ff) border-box;
      -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
      opacity: 0;
      animation: glowPulse 2s ease-in-out infinite;
    }

    .vinyl-glow.playing {
      opacity: 1;
    }

    @keyframes glowPulse {
      0%, 100% { transform: scale(1); opacity: 0.6; }
      50% { transform: scale(1.1); opacity: 1; }
    }

    /* Info traccia */
    .track-info {
      text-align: center;
      margin-bottom: 30px;
      max-width: 90%;
    }

    .track-title {
      font-size: 1.3rem;
      font-weight: 600;
      margin-bottom: 8px;
      color: #fff;
      text-shadow: 0 0 20px rgba(0, 255, 255, 0.6);
      min-height: 2.6em;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .track-meta {
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.6);
      letter-spacing: 1px;
    }

    /* Controlli */
    .controls {
      width: 100%;
      max-width: 400px;
      padding: 0 20px;
    }

    .main-controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin-bottom: 30px;
    }

    .btn {
      border: none;
      background: none;
      cursor: pointer;
      padding: 0;
      transition: all 0.3s ease;
      position: relative;
    }

    .btn:active {
      transform: scale(0.95);
    }

    .btn-small {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: rgba(139, 0, 255, 0.2);
      border: 2px solid rgba(139, 0, 255, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .btn-small:hover {
      background: rgba(139, 0, 255, 0.4);
      border-color: rgba(139, 0, 255, 0.8);
      box-shadow: 0 0 20px rgba(139, 0, 255, 0.6);
    }

    .btn-play {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: linear-gradient(135deg, #8b00ff 0%, #00ffff 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 40px rgba(139, 0, 255, 0.6);
      position: relative;
      overflow: hidden;
    }

    .btn-play::before {
      content: '';
      position: absolute;
      inset: -50%;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.3), transparent);
      transform: translateX(-100%);
      transition: transform 0.6s;
    }

    .btn-play:hover::before {
      transform: translateX(100%);
    }

    .btn-play:hover {
      box-shadow: 0 10px 50px rgba(0, 255, 255, 0.8);
      transform: scale(1.05);
    }

    .btn svg {
      width: 24px;
      height: 24px;
      fill: #fff;
      position: relative;
      z-index: 1;
    }

    .btn-play svg {
      width: 32px;
      height: 32px;
    }

    /* Volume */
    .volume-control {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
    }

    .volume-control span {
      font-size: 0.8rem;
      color: rgba(255, 255, 255, 0.6);
      letter-spacing: 1px;
      min-width: 60px;
    }

    .volume-slider {
      flex: 1;
      height: 6px;
      -webkit-appearance: none;
      appearance: none;
      background: rgba(139, 0, 255, 0.3);
      border-radius: 10px;
      outline: none;
      position: relative;
    }

    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: linear-gradient(135deg, #8b00ff, #00ffff);
      cursor: pointer;
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.8);
      transition: all 0.3s ease;
    }

    .volume-slider::-webkit-slider-thumb:hover {
      transform: scale(1.2);
      box-shadow: 0 0 30px rgba(0, 255, 255, 1);
    }

    .volume-slider::-moz-range-thumb {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: linear-gradient(135deg, #8b00ff, #00ffff);
      cursor: pointer;
      border: none;
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.8);
    }

    /* Playlist selector */
    .playlist-selector {
      margin-bottom: 20px;
    }

    .playlist-select {
      width: 100%;
      padding: 14px 20px;
      background: rgba(139, 0, 255, 0.2);
      border: 2px solid rgba(139, 0, 255, 0.5);
      border-radius: 12px;
      color: #fff;
      font-family: "Rajdhani", sans-serif;
      font-size: 1rem;
      font-weight: 500;
      letter-spacing: 1px;
      outline: none;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .playlist-select:focus {
      border-color: rgba(0, 255, 255, 0.8);
      box-shadow: 0 0 20px rgba(0, 255, 255, 0.4);
      background: rgba(139, 0, 255, 0.3);
    }

    .playlist-select option {
      background: #1a1a1a;
      color: #fff;
      padding: 10px;
    }

    /* Status */
    .status {
      text-align: center;
      font-size: 0.85rem;
      color: rgba(255, 255, 255, 0.5);
      letter-spacing: 1px;
    }

    /* Hidden player */
    #player-container {
      position: absolute;
      width: 0;
      height: 0;
      opacity: 0;
      pointer-events: none;
      overflow: hidden;
    }

    @media (max-height: 700px) {
      .header { padding: 20px 24px 15px; }
      .logo-text { font-size: 2.2rem; }
      .vinyl-container { width: 220px; height: 220px; margin-bottom: 30px; }
      .btn-play { width: 70px; height: 70px; }
      .btn-small { width: 45px; height: 45px; }
    }
  </style>
</head>
<body>
  <!-- Background animato -->
  <div class="bg-container">
    <div class="dna-strand"></div>
    <div class="dna-strand"></div>
    <div class="dna-strand"></div>
    <div class="dna-strand"></div>
    <div class="audio-wave" id="audioWave"></div>
  </div>

  <!-- App principale -->
  <div class="app">
    <header class="header">
      <div class="logo-container">
        <div class="logo-text">DarkDna</div>
        <div class="logo-subtitle">Radio</div>
        <div class="live-indicator">
          <span class="live-dot"></span>
          <span>LIVE STREAMING</span>
        </div>
      </div>
    </header>

    <section class="player-section">
      <!-- Vinyl disc -->
      <div class="vinyl-container">
        <div class="vinyl-glow" id="vinylGlow"></div>
        <div class="vinyl-disc" id="vinylDisc"></div>
      </div>

      <!-- Track info -->
      <div class="track-info">
        <div class="track-title" id="trackTitle">Caricamento della playlist...</div>
        <div class="track-meta">
          <span id="trackPosition">Traccia - / -</span>
        </div>
      </div>

      <!-- Controls -->
      <div class="controls">
        <div class="main-controls">
          <button class="btn btn-small" id="prevBtn" title="Precedente" disabled>
            <svg viewBox="0 0 24 24">
              <path d="M6 5a1 1 0 0 0-1 1v12a1 1 0 1 0 2 0V6a1 1 0 0 0-1-1zm3.9 7.62 7.14 4.26A1 1 0 0 0 19 16.99V7.01a1 1 0 0 0-1.96-.89L9.9 10.38a1.42 1.42 0 0 0 0 2.24z" />
            </svg>
          </button>

          <button class="btn btn-play" id="playBtn" title="Play/Pausa" disabled>
            <svg id="playIcon" viewBox="0 0 24 24">
              <path d="M8 5.14v13.72a1 1 0 0 0 1.52.85l9-6.86a1 1 0 0 0 0-1.7l-9-6.86A1 1 0 0 0 8 5.14z" />
            </svg>
            <svg id="pauseIcon" viewBox="0 0 24 24" style="display:none">
              <path d="M8 5a1 1 0 0 0-1 1v12a1 1 0 0 0 2 0V6a1 1 0 0 0-1-1zm8 0a1 1 0 0 0-1 1v12a1 1 0 0 0 2 0V6a1 1 0 0 0-1-1z" />
            </svg>
          </button>

          <button class="btn btn-small" id="nextBtn" title="Successivo" disabled>
            <svg viewBox="0 0 24 24">
              <path d="M18 19a1 1 0 0 0 1-1V6a1 1 0 1 0-2 0v12a1 1 0 0 0 1 1zm-3.9-6.62-7.14-4.26A1 1 0 0 0 5 7.01v9.98a1 1 0 0 0 1.96.89l7.14-4.26a1.42 1.42 0 0 0 0-2.24z" />
            </svg>
          </button>
        </div>

        <div class="volume-control">
          <span>VOLUME</span>
          <input type="range" class="volume-slider" id="volumeSlider" min="0" max="100" value="70" disabled />
          <button class="btn btn-small" id="muteBtn" title="Muto" disabled>
            <svg id="volumeOnIcon" viewBox="0 0 24 24">
              <path d="M5 9v6a1 1 0 0 0 1 1h2.76l4.32 3.24A1 1 0 0 0 15 18.4V5.6a1 1 0 0 0-1.92-.84L8.76 8H6a1 1 0 0 0-1 1z" />
              <path d="M17.66 8.34a1 1 0 0 0-1.41 1.41A3 3 0 0 1 17 12a3 3 0 0 1-.75 2 1 1 0 1 0 1.57 1.25A5.05 5.05 0 0 0 19 12a5.05 5.05 0 0 0-1.34-3.41z" />
            </svg>
            <svg id="volumeOffIcon" viewBox="0 0 24 24" style="display:none">
              <path d="M7.05 4.64A1 1 0 1 0 5.64 6.05L7.59 8H6a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.76l4.32 3.24A1 1 0 0 0 15 18.4v-4.73l2.95 2.96a1 1 0 0 0 1.41-1.41zM13 7.6v3.12l-2.58-2.58z" />
            </svg>
          </button>
        </div>

        <div class="playlist-selector">
          <select class="playlist-select" id="playlistSelect"></select>
        </div>

        <div class="status" id="statusText">Inizializzazione player...</div>
      </div>
    </section>
  </div>

  <!-- Hidden YouTube player -->
  <div id="player-container">
    <div id="player"></div>
  </div>

  <script src="https://www.youtube.com/iframe_api"></script>
  <script>
    const PLAYLISTS = [
      { id: "PLKR0ZRenRrdzHodMKBL46T7xtbuT6MSrX", name: "Romantic Vibes" },
      { id: "PLKR0ZRenRrdwsxChStGPfp5vaXCUGDcWa", name: "Dance Floor" },
      { id: "PLKR0ZRenRrdzGcAEuqbAj4oVoPub6n89l", name: "Pop/Rock Classics" },
      { id: "PLKR0ZRenRrdzhW0pzppxVV1r3lnpN-7Ml", name: "Best of Mix" },
      { id: "PLKR0ZRenRrdw9_2GLQFNwDHf3vLrLfc2N", name: "Fun Times" }
    ];

    let player = null;
    let isReady = false;
    let isPlaying = false;
    let apiReady = false;
    let currentPlaylistId = PLAYLISTS[0].id;

    const playBtn = document.getElementById("playBtn");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const muteBtn = document.getElementById("muteBtn");
    const volumeSlider = document.getElementById("volumeSlider");
    const playIcon = document.getElementById("playIcon");
    const pauseIcon = document.getElementById("pauseIcon");
    const volumeOnIcon = document.getElementById("volumeOnIcon");
    const volumeOffIcon = document.getElementById("volumeOffIcon");
    const trackTitle = document.getElementById("trackTitle");
    const trackPosition = document.getElementById("trackPosition");
    const statusText = document.getElementById("statusText");
    const playlistSelect = document.getElementById("playlistSelect");
    const vinylDisc = document.getElementById("vinylDisc");
    const vinylGlow = document.getElementById("vinylGlow");
    const audioWave = document.getElementById("audioWave");

    // Create audio wave bars
    for (let i = 0; i < 30; i++) {
      const bar = document.createElement('div');
      bar.className = 'wave-bar paused';
      bar.style.animationDelay = `${Math.random() * 0.5}s`;
      audioWave.appendChild(bar);
    }

    // Create floating particles
    const bgContainer = document.querySelector('.bg-container');
    for (let i = 0; i < 50; i++) {
      const particle = document.createElement('div');
      particle.className = 'particle';
      particle.style.left = `${Math.random() * 100}%`;
      particle.style.top = `${Math.random() * 100}%`;
      particle.style.setProperty('--tx', `${(Math.random() - 0.5) * 200}px`);
      particle.style.setProperty('--ty', `${(Math.random() - 0.5) * 200}px`);
      particle.style.animationDelay = `${Math.random() * 15}s`;
      bgContainer.appendChild(particle);
    }

    function cleanTitle(raw) {
      if (!raw) return "";
      const hashIndex = raw.indexOf("#");
      return hashIndex !== -1 ? raw.slice(0, hashIndex).trim() : raw.trim();
    }

    function setControlsEnabled(enabled) {
      playBtn.disabled = !enabled;
      prevBtn.disabled = !enabled;
      nextBtn.disabled = !enabled;
      muteBtn.disabled = !enabled;
      volumeSlider.disabled = !enabled;
    }

    function updateTrackInfo() {
      if (!player || !isReady) return;
      const data = player.getVideoData();
      const title = cleanTitle(data?.title || "Traccia sconosciuta");
      const index = player.getPlaylistIndex?.() ?? -1;
      const playlist = player.getPlaylist?.() ?? null;
      const total = Array.isArray(playlist) ? playlist.length : null;

      trackTitle.textContent = title;
      trackPosition.textContent = index >= 0 && total ? `Traccia ${index + 1} / ${total}` : "Traccia - / -";
    }

    function updatePlayPauseUI(nowPlaying) {
      isPlaying = nowPlaying;
      playIcon.style.display = nowPlaying ? "none" : "block";
      pauseIcon.style.display = nowPlaying ? "block" : "none";
      
      if (nowPlaying) {
        vinylDisc.classList.add("playing");
        vinylGlow.classList.add("playing");
        statusText.textContent = "In riproduzione";
        document.querySelectorAll('.wave-bar').forEach(bar => {
          bar.classList.remove('paused');
          bar.classList.add('playing');
        });
      } else {
        vinylDisc.classList.remove("playing");
        vinylGlow.classList.remove("playing");
        statusText.textContent = "In pausa";
        document.querySelectorAll('.wave-bar').forEach(bar => {
          bar.classList.remove('playing');
          bar.classList.add('paused');
        });
      }
    }

    function updateMuteUI() {
      if (!player) return;
      const muted = player.isMuted();
      volumeOnIcon.style.display = muted ? "none" : "block";
      volumeOffIcon.style.display = muted ? "block" : "none";
    }

    function createPlayer() {
      if (!apiReady) return;
      isReady = false;
      setControlsEnabled(false);
      statusText.textContent = "Caricamento playlist...";
      trackTitle.textContent = "Caricamento...";

      if (player?.destroy) {
        try { player.destroy(); } catch (e) { console.error(e); }
        player = null;
      }

      player = new YT.Player("player", {
        height: "0",
        width: "0",
        playerVars: {
          listType: "playlist",
          list: currentPlaylistId,
          autoplay: 1,
          controls: 0,
          rel: 0,
          modestbranding: 1
        },
        events: {
          onReady: onPlayerReady,
          onStateChange: onPlayerStateChange,
          onError: onPlayerError
        }
      });
    }

    window.onYouTubeIframeAPIReady = function () {
      apiReady = true;
      createPlayer();
    };

    function onPlayerReady() {
      isReady = true;
      setControlsEnabled(true);
      const vol = parseInt(volumeSlider.value, 10) || 70;
      player.setVolume(vol);
      statusText.textContent = "Pronto";
      
      try {
        player.playVideo();
      } catch (e) {
        console.error("Autoplay bloccato:", e);
        statusText.textContent = "Premi Play per iniziare";
      }
      
      updateTrackInfo();
    }

    function onPlayerStateChange(event) {
      if (event.data === YT.PlayerState.PLAYING) {
        updateTrackInfo();
        updatePlayPauseUI(true);
      } else if (event.data === YT.PlayerState.PAUSED) {
        updatePlayPauseUI(false);
      } else if (event.data === YT.PlayerState.ENDED) {
        statusText.textContent = "Prossima traccia...";
      } else if (event.data === YT.PlayerState.BUFFERING) {
        statusText.textContent = "Buffering...";
      }
    }

    function onPlayerError(event) {
      console.error("Player error:", event.data);
      alert("Errore nella riproduzione. Codice: " + event.data);
      statusText.textContent = "Errore di riproduzione";
      trackTitle.textContent = "Impossibile riprodurre";
    }

    function togglePlayPause() {
      if (!player || !isReady) return;
      const state = player.getPlayerState();
      if (state === YT.PlayerState.PLAYING) {
        player.pauseVideo();
      } else {
        player.playVideo();
      }
    }

    function nextTrack() {
      if (!player || !isReady) return;
      player.nextVideo();
      statusText.textContent = "Prossima traccia...";
    }

    function prevTrack() {
      if (!player || !isReady) return;
      player.previousVideo();
      statusText.textContent = "Traccia precedente...";
    }

    function toggleMute() {
      if (!player || !isReady) return;
      if (player.isMuted()) {
        player.unMute();
      } else {
        player.mute();
      }
      updateMuteUI();
    }

    function changeVolume(value) {
      if (!player || !isReady) return;
      const vol = parseInt(value, 10);
      if (!isNaN(vol)) {
        player.setVolume(vol);
        if (player.isMuted() && vol > 0) {
          player.unMute();
          updateMuteUI();
        }
      }
    }

    function handlePlaylistChange(newPlaylistId) {
      currentPlaylistId = newPlaylistId;
      createPlayer();
    }

    document.addEventListener("DOMContentLoaded", () => {
      setControlsEnabled(false);

      PLAYLISTS.forEach((pl, index) => {
        const opt = document.createElement("option");
        opt.value = pl.id;
        opt.textContent = pl.name;
        if (index === 0) opt.selected = true;
        playlistSelect.appendChild(opt);
      });

      playlistSelect.addEventListener("change", (e) => {
        handlePlaylistChange(e.target.value);
      });

      playBtn.addEventListener("click", togglePlayPause);
      nextBtn.addEventListener("click", nextTrack);
      prevBtn.addEventListener("click", prevTrack);
      muteBtn.addEventListener("click", toggleMute);
      volumeSlider.addEventListener("input", (e) => changeVolume(e.target.value));
    });
  </script>
</body>
</html>
